!function(a,b){"use strict";function R(b,c,d){"addEventListener"in a?b.addEventListener(c,d,!1):"attachEvent"in a&&b.attachEvent("on"+c,d)}function S(b,c,d){"removeEventListener"in a?b.removeEventListener(c,d,!1):"detachEvent"in a&&b.detachEvent("on"+c,d)}function T(a){return a.charAt(0).toUpperCase()+a.slice(1)}function U(a){var b,c,d,e=null,f=0,g=function(){f=V(),e=null,d=a.apply(b,c),e||(b=c=null)};return function(){var h=V();f||(f=h);var i=I-(h-f);return b=this,c=arguments,i<=0||i>I?(e&&(clearTimeout(e),e=null),f=h,d=a.apply(b,c),e||(b=c=null)):e||(e=setTimeout(g,i)),d}}function W(a){return w+"["+y+"] "+a}function X(b){v&&"object"==typeof a.console&&console.log(W(b))}function Y(b){"object"==typeof a.console&&console.warn(W(b))}function Z(){$(),X("Initialising iFrame ("+location.href+")"),_(),ca(),ba("background",e),ba("padding",i),pa(),ha(),ia(),da(),ra(),ja(),s=qa(),Fa("init","Init message from host page"),O()}function $(){function a(a){return"true"===a}var d=r.substr(x).split(":");y=d[0],f=b!==d[1]?Number(d[1]):f,j=b!==d[2]?a(d[2]):j,v=b!==d[3]?a(d[3]):v,t=b!==d[4]?Number(d[4]):t,c=b!==d[6]?a(d[6]):c,g=d[7],p=b!==d[8]?d[8]:p,e=d[9],i=d[10],F=b!==d[11]?Number(d[11]):F,s.enable=b!==d[12]&&a(d[12]),B=b!==d[13]?d[13]:B,L=b!==d[14]?d[14]:L}function _(){function b(){var b=a.iFrameResizer;X("Reading data from page: "+JSON.stringify(b)),N="messageCallback"in b?b.messageCallback:N,O="readyCallback"in b?b.readyCallback:O,E="targetOrigin"in b?b.targetOrigin:E,p="heightCalculationMethod"in b?b.heightCalculationMethod:p,L="widthCalculationMethod"in b?b.widthCalculationMethod:L}function c(a,b){return"function"==typeof a&&(X("Setup custom "+b+"CalcMethod"),Q[b]=a,a="custom"),a}"iFrameResizer"in a&&Object===a.iFrameResizer.constructor&&(b(),p=c(p,"height"),L=c(L,"width")),X("TargetOrigin for parent set to: "+E)}function aa(a,b){return-1!==b.indexOf("-")&&(Y("Negative CSS value ignored for "+a),b=""),b}function ba(a,c){b!==c&&""!==c&&"null"!==c&&(document.body.style[a]=c,X("Body "+a+' set to "'+c+'"'))}function ca(){b===g&&(g=f+"px"),ba("margin",aa("margin",g))}function da(){document.documentElement.style.height="",document.body.style.height="",X('HTML & body height set to "auto"')}function ea(b){function c(){Fa(b.eventName,b.eventType)}var d={add:function(b){R(a,b,c)},remove:function(b){S(a,b,c)}};b.eventNames&&Array.prototype.map?(b.eventName=b.eventNames[0],b.eventNames.map(d[b.method])):d[b.method](b.eventName),X(T(b.method)+" event listener: "+b.eventType)}function fa(a){ea({method:a,eventType:"Animation Start",eventNames:["animationstart","webkitAnimationStart"]}),ea({method:a,eventType:"Animation End",eventNames:["animationend","webkitAnimationEnd"]}),ea({method:a,eventType:"Input",eventName:"input"}),ea({method:a,eventType:"Mouse Up",eventName:"mouseup"}),ea({method:a,eventType:"Mouse Down",eventName:"mousedown"}),ea({method:a,eventType:"Orientation Change",eventName:"orientationchange"}),ea({method:a,eventType:"Print",eventName:["afterprint","beforeprint"]}),ea({method:a,eventType:"Ready State Change",eventName:"readystatechange"}),ea({method:a,eventType:"Touch Start",eventName:"touchstart"}),ea({method:a,eventType:"Touch End",eventName:"touchend"}),ea({method:a,eventType:"Touch Cancel",eventName:"touchcancel"}),ea({method:a,eventType:"Transition Start",eventNames:["transitionstart","webkitTransitionStart","MSTransitionStart","oTransitionStart","otransitionstart"]}),ea({method:a,eventType:"Transition Iteration",eventNames:["transitioniteration","webkitTransitionIteration","MSTransitionIteration","oTransitionIteration","otransitioniteration"]}),ea({method:a,eventType:"Transition End",eventNames:["transitionend","webkitTransitionEnd","MSTransitionEnd","oTransitionEnd","otransitionend"]}),"child"===B&&ea({method:a,eventType:"IFrame Resized",eventName:"resize"})}function ga(a,b,c,d){return b!==a&&(a in c||(Y(a+" is not a valid option for "+d+"CalculationMethod."),a=b),X(d+' calculation method set to "'+a+'"')),a}function ha(){p=ga(p,o,Ba,"height")}function ia(){L=ga(L,K,Ca,"width")}function ja(){!0===c?(fa("add"),ua()):X("Auto Resize disabled")}function ka(){X("Disable outgoing messages"),C=!1}function la(){X("Remove event listener: Message"),S(a,"message",Ka)}function ma(){null!==h&&h.disconnect()}function na(){fa("remove"),ma(),clearInterval(u)}function oa(){ka(),la(),!0===c&&na()}function pa(){var a=document.createElement("div");a.style.clear="both",a.style.display="block",document.body.appendChild(a)}function qa(){function c(){return{x:a.pageXOffset!==b?a.pageXOffset:document.documentElement.scrollLeft,y:a.pageYOffset!==b?a.pageYOffset:document.documentElement.scrollTop}}function d(a){var b=a.getBoundingClientRect(),d=c();return{x:parseInt(b.left,10)+parseInt(d.x,10),y:parseInt(b.top,10)+parseInt(d.y,10)}}function e(a){function c(a){var b=d(a);X("Moving to in page link (#"+e+") at x: "+b.x+" y: "+b.y),Ja(b.y,b.x,"scrollToOffset")}var e=a.split("#")[1]||a,f=decodeURIComponent(e),g=document.getElementById(f)||document.getElementsByName(f)[0];b!==g?c(g):(X("In page link (#"+e+") not found in iFrame, so sending to parent"),Ja(0,0,"inPageLink","#"+e))}function f(){""!==location.hash&&"#"!==location.hash&&e(location.href)}function g(){function a(a){function b(a){a.preventDefault(),e(this.getAttribute("href"))}"#"!==a.getAttribute("href")&&R(a,"click",b)}Array.prototype.forEach.call(document.querySelectorAll('a[href^="#"]'),a)}function h(){R(a,"hashchange",f)}function i(){setTimeout(f,l)}function j(){Array.prototype.forEach&&document.querySelectorAll?(X("Setting up location.hash handlers"),g(),h(),i()):Y("In page linking not fully supported in this browser! (See README.md for IE8 workaround)")}return s.enable?j():X("In page linking not enabled"),{findTarget:e}}function ra(){X("Enable public methods"),M.parentIFrame={autoResize:function(b){return!0===b&&!1===c?(c=!0,ja()):!1===b&&!0===c&&(c=!1,na()),c},close:function(){Ja(0,0,"close"),oa()},getId:function(){return y},getPageInfo:function(b){"function"==typeof b?(P=b,Ja(0,0,"pageInfo")):(P=function(){},Ja(0,0,"pageInfoStop"))},moveToAnchor:function(b){s.findTarget(b)},reset:function(){Ia("parentIFrame.reset")},scrollTo:function(b,c){Ja(c,b,"scrollTo")},scrollToOffset:function(b,c){Ja(c,b,"scrollToOffset")},sendMessage:function(b,c){Ja(0,0,"message",JSON.stringify(b),c)},setHeightCalculationMethod:function(b){p=b,ha()},setWidthCalculationMethod:function(b){L=b,ia()},setTargetOrigin:function(b){X("Set targetOrigin: "+b),E=b},size:function(b,c){var d=""+(b?b:"")+(c?","+c:"");Fa("size","parentIFrame.size("+d+")",b,c)}}}function sa(){0!==t&&(X("setInterval: "+t+"ms"),u=setInterval(function(){Fa("interval","setInterval: "+t)},Math.abs(t)))}function ta(){function c(a){function b(a){!1===a.complete&&(X("Attach listeners to "+a.src),a.addEventListener("load",g,!1),a.addEventListener("error",h,!1),k.push(a))}"attributes"===a.type&&"src"===a.attributeName?b(a.target):"childList"===a.type&&Array.prototype.forEach.call(a.target.querySelectorAll("img"),b)}function d(a){k.splice(k.indexOf(a),1)}function e(a){X("Remove listeners from "+a.src),a.removeEventListener("load",g,!1),a.removeEventListener("error",h,!1),d(a)}function f(a,c,d){e(a.target),Fa(c,d+": "+a.target.src,b,b)}function g(a){f(a,"imageLoad","Image loaded")}function h(a){f(a,"imageLoadFailed","Image load failed")}function i(a){Fa("mutationObserver","mutationObserver: "+a[0].target+" "+a[0].type),a.forEach(c)}function j(){var a=document.querySelector("body"),b={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0};return m=new l(i),X("Create body MutationObserver"),m.observe(a,b),m}var k=[],l=a.MutationObserver||a.WebKitMutationObserver,m=j();return{disconnect:function(){"disconnect"in m&&(X("Disconnect body MutationObserver"),m.disconnect(),k.forEach(e))}}}function ua(){var b=0>t;a.MutationObserver||a.WebKitMutationObserver?b?sa():h=ta():(X("MutationObserver not supported in this browser!"),sa())}function va(a,b){function c(a){var c=/^\d+(px)?$/i;if(c.test(a))return parseInt(a,d);var e=b.style.left,f=b.runtimeStyle.left;return b.runtimeStyle.left=b.currentStyle.left,b.style.left=a||0,a=b.style.pixelLeft,b.style.left=e,b.runtimeStyle.left=f,a}var e=0;return b=b||document.body,"defaultView"in document&&"getComputedStyle"in document.defaultView?(e=document.defaultView.getComputedStyle(b,null),e=null!==e?e[a]:0):e=c(b.currentStyle[a]),parseInt(e,d)}function wa(a){a>I/2&&(I=2*a,X("Event throttle increased to "+I+"ms"))}function xa(a,b){for(var c=b.length,d=0,e=0,f=T(a),g=V(),h=0;h<c;h++)d=b[h].getBoundingClientRect()[a]+va("margin"+f,b[h]),d>e&&(e=d);return g=V()-g,X("Parsed "+c+" HTML elements"),X("Element position calculated in "+g+"ms"),wa(g),e}function ya(a){return[a.bodyOffset(),a.bodyScroll(),a.documentElementOffset(),a.documentElementScroll()]}function za(a,b){function c(){return Y("No tagged elements ("+b+") found on page"),n}var d=document.querySelectorAll("["+b+"]");return 0===d.length?c():xa(a,d)}function Aa(){return document.querySelectorAll("body *")}function Da(a,c,d,e){function f(){n=m,J=o,Ja(n,J,a)}function g(){function a(a,b){var c=Math.abs(a-b)<=F;return!c}return m=b!==d?d:Ba[p](),o=b!==e?e:Ca[L](),a(n,m)||j&&a(J,o)}function h(){return!(a in{init:1,interval:1,size:1})}function i(){return p in A||j&&L in A}function k(){X("No change in size detected")}function l(){h()&&i()?Ia(c):a in{interval:1}||k()}var m,o;g()||"init"===a?(Ga(),f()):l()}function Fa(a,b,c,d){function e(){a in{reset:1,resetPage:1,init:1}||X("Trigger event: "+b)}function f(){return G&&a in k}f()?X("Trigger event cancelled: "+a):(e(),Ea(a,b,c,d))}function Ga(){G||(G=!0,X("Trigger event lock on")),clearTimeout(H),H=setTimeout(function(){G=!1,X("Trigger event lock off"),X("--")},l)}function Ha(a){n=Ba[p](),J=Ca[L](),Ja(n,J,a)}function Ia(a){var b=p;p=o,X("Reset trigger event: "+a),Ga(),Ha("reset"),p=b}function Ja(a,c,d,e,f){function g(){b===f?f=E:X("Message targetOrigin: "+f)}function h(){var g=a+":"+c,h=y+":"+g+":"+d+(b!==e?":"+e:"");X("Sending message to host page ("+h+")"),D.postMessage(w+h,f)}!0===C&&(g(),h())}function Ka(b){function c(){return w===(""+b.data).substr(0,x)}function d(){function c(){r=b.data,D=b.source,Z(),m=!1,setTimeout(function(){q=!1},l)}document.body?c():(X("Waiting for page ready"),R(a,"readystatechange",d))}function e(){q?X("Page reset ignored by init"):(X("Page size reset by host page"),Ha("resetPage"))}function f(){Fa("resizeParent","Parent window requested size check")}function g(){var a=i();s.findTarget(a)}function h(){return b.data.split("]")[1].split(":")[0]}function i(){return b.data.substr(b.data.indexOf(":")+1)}function j(){return"iFrameResize"in a}function k(){var a=i();X("MessageCallback called from parent: "+a),N(JSON.parse(a)),X(" --")}function n(){var a=i();X("PageInfoFromParent called from parent: "+a),P(JSON.parse(a)),X(" --")}function o(){return b.data.split(":")[2]in{true:1,false:1}}function p(){switch(h()){case"reset":e();break;case"resize":f();break;case"inPageLink":case"moveToAnchor":g();break;case"message":k();break;case"pageInfo":n();break;default:j()||o()||Y("Unexpected message ("+b.data+")")}}function t(){!1===m?p():o()?d():X('Ignored message of type "'+h()+'". Received before initialization.')}c()&&t()}function La(){"loading"!==document.readyState&&a.parent.postMessage("[iFrameResizerChild]Ready","*")}var c=!0,d=10,e="",f=0,g="",h=null,i="",j=!1,k={resize:1,click:1},l=128,m=!0,n=1,o="bodyOffset",p=o,q=!0,r="",s={},t=32,u=null,v=!1,w="[iFrameSizer]",x=w.length,y="",A={max:1,min:1,bodyScroll:1,documentElementScroll:1},B="child",C=!0,D=a.parent,E="*",F=0,G=!1,H=null,I=16,J=1,K="scroll",L=K,M=a,N=function(){Y("MessageCallback function not defined")},O=function(){},P=function(){},Q={height:function(){return Y("Custom height calculation function not defined"),document.documentElement.offsetHeight},width:function(){return Y("Custom width calculation function not defined"),document.body.scrollWidth}},V=Date.now||function(){return(new Date).getTime()},Ba={bodyOffset:function(){return document.body.offsetHeight+va("marginTop")+va("marginBottom")},offset:function(){return Ba.bodyOffset()},bodyScroll:function(){return document.body.scrollHeight},custom:function(){return Q.height()},documentElementOffset:function(){return document.documentElement.offsetHeight},documentElementScroll:function(){return document.documentElement.scrollHeight},max:function(){return Math.max.apply(null,ya(Ba))},min:function(){return Math.min.apply(null,ya(Ba))},grow:function(){return Ba.max()},lowestElement:function(){return Math.max(Ba.bodyOffset(),xa("bottom",Aa()))},taggedElement:function(){return za("bottom","data-iframe-height")}},Ca={bodyScroll:function(){return document.body.scrollWidth},bodyOffset:function(){return document.body.offsetWidth},custom:function(){return Q.width()},documentElementScroll:function(){return document.documentElement.scrollWidth},documentElementOffset:function(){return document.documentElement.offsetWidth},scroll:function(){return Math.max(Ca.bodyScroll(),Ca.documentElementScroll())},max:function(){return Math.max.apply(null,ya(Ca))},min:function(){return Math.min.apply(null,ya(Ca))},rightMostElement:function(){return xa("right",Aa())},taggedElement:function(){return za("right","data-iframe-width")}},Ea=U(Da);R(a,"message",Ka),La()}(window||{});
